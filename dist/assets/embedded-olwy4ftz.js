import"./modulepreload-polyfill-B5Qt9EMX.js";import*as e from"https://unpkg.com/three@0.150.1/build/three.module.js";import{OBJLoader as a}from"https://unpkg.com/three@0.150.1/examples/jsm/loaders/OBJLoader.js";import{OrbitControls as c}from"https://unpkg.com/three@0.150.1/examples/jsm/controls/OrbitControls.js";class h{constructor(i="viewer-container"){this.container=document.getElementById(i)||document.body,this.currentModel=null,this.initScene(),this.initLights(),this.initControls(),this.setupEventListeners(),this.loadShelfModel()}initScene(){this.scene=new e.Scene,this.scene.background=new e.Color(16777215),this.scene.fog=new e.Fog(16777215,1,30);const i=40,t=new e.GridHelper(i,40,13421772,15132390);t.position.y=-1.4,this.scene.add(t);const s=new e.PlaneGeometry(i,i/2),n=new e.MeshStandardMaterial({color:14737632,side:e.FrontSide,roughness:.8,metalness:.1}),r=new e.Mesh(s,n);r.position.z=-40/4,r.position.y=i/4-1.4,this.scene.add(r),this.camera=new e.PerspectiveCamera(60,this.container.clientWidth/this.container.clientHeight,.1,1e3),this.camera.position.set(5.1,4.85,9.99),this.renderer=new e.WebGLRenderer({antialias:!0}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.container.appendChild(this.renderer.domElement)}initLights(){const i=new e.AmbientLight(4210752,.5);this.scene.add(i);const t=new e.HemisphereLight(16777215,4473924,.8);this.scene.add(t);const s=new e.DirectionalLight(16777215,1);s.position.set(1,1,2),this.scene.add(s);const n=new e.DirectionalLight(16777215,.3);n.position.set(0,1,-1),this.scene.add(n)}initControls(){this.controls=new c(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.rotateSpeed=.5,this.controls.minDistance=4,this.controls.maxDistance=20,this.controls.target.set(1.28,3.82,.12),this.controls.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},this.controls.minPolarAngle=0,this.controls.maxPolarAngle=Math.PI,this.controls.minAzimuthAngle=-1/0,this.controls.maxAzimuthAngle=1/0,this.controls.enablePan=!0,this.controls.panSpeed=.5}setupEventListeners(){window.addEventListener("resize",()=>{this.camera.aspect=this.container.clientWidth/this.container.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight)})}async loadShelfModel(){new a().load("./models/Shelf.obj",t=>{t.traverse(n=>{n instanceof e.Mesh&&(n.material=new e.MeshStandardMaterial({color:8421504,flatShading:!1,roughness:.7,metalness:.3}))}),t.scale.set(.005,.005,.005);const s=new e.Box3().setFromObject(t);t.position.y=-s.min.y*t.scale.y+8.529,this.scene.add(t),this.currentModel=t})}animate(){this.animationFrameId=requestAnimationFrame(this.animate.bind(this)),this.controls.update(),this.renderer.render(this.scene,this.camera)}dispose(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.controls&&this.controls.dispose(),this.currentModel=null,this.scene=null,this.camera=null,this.renderer.dispose()}}document.addEventListener("DOMContentLoaded",()=>{const o=new h("viewer-container");o.animate(),window.embeddedViewer=o});
